{"componentChunkName":"component---src-pages-cpd-design-process-provision-infra-mdx","path":"/cpd-design/process/provision-infra/","result":{"pageContext":{"frontmatter":{"title":"Provision infrastructure","tabs":["Overview","Validate","Prepare","Provision-infra","Configure-infra","Install-cloud-pak","Configure-cloud-pak","Deploy-assets","Smoke-tests"]},"relativePagePath":"/cpd-design/process/provision-infra.mdx","titleType":"page","MdxNode":{"id":"d62a386d-b75e-5020-8b70-0b8c13440be2","children":[],"parent":"b689c139-e4e0-53fc-92af-7da043df6b77","internal":{"content":"---\ntitle: Provision infrastructure\ntabs: ['Overview', 'Validate', 'Prepare', 'Provision-infra', 'Configure-infra', 'Install-cloud-pak', 'Configure-cloud-pak', 'Deploy-assets', 'Smoke-tests']\n---\n\n# Provision infrastructure\n\nThis stage will provision the infrastructure that was defined in the input configuration files. Currently, this has only been implemented for IBM Cloud.\n\n## IBM Cloud\nThe IBM Cloud infrastructure provisioning runs Terraform to initially provision the infrastructure components such as VPC, VSIs, security groups, ROKS cluster and others. Also, if changes have been made in the configuration, Terraform will attempt to make the changes to reach the desired end-state.\n\nBased on the chosen action (apply or destroy), Terraform is instructed to provision or change the infrastructure components or to destroy everything.\n\nThe Terraform state file (tfstate) is maintained in the vault and is critical to enable dynamic updates to the infrastructure. If the state file is lost or corrupted, updates to the infrastructure will have to be done manually. The Ansible tasks have been built in a way that the Terraform state file is always persisted into the vault, even if the apply or destroy process has failed.\n\nThere are 3 main steps:\n\n#### Terraform init\nThis step initializes the Terraform provider (ibm) with the correct version. If needed, the Terraform modules for the provider are downloaded or updated.\n\n#### Terraform plan\nApplying changes to the infrastructure using Terraform based on the input configuration files may cause critical components to be replaced (destroyed and recreated). The plan step checks **what** will be changed. If infrastructure components are destroyed and the `--confirm-destroy` parameter has not be specified for the deployer, the process is aborted.\n\n#### Terraform apply or Terraform destroy\nThis is the execution of the plan and will provision new infrastructure (apply) or destroy everything (destroy).\n\nWhile the Terraform apply or destroy process is running, a `.tfstate` file is updated on disk. When the command completes, the deployer writes this as a secret to the vault so it can be used next time to update (or destroy) the infrastructure components.\n","type":"Mdx","contentDigest":"563a042b665fdbbf2e639526266e77b2","owner":"gatsby-plugin-mdx","counter":233},"frontmatter":{"title":"Provision infrastructure","tabs":["Overview","Validate","Prepare","Provision-infra","Configure-infra","Install-cloud-pak","Configure-cloud-pak","Deploy-assets","Smoke-tests"]},"exports":{},"rawBody":"---\ntitle: Provision infrastructure\ntabs: ['Overview', 'Validate', 'Prepare', 'Provision-infra', 'Configure-infra', 'Install-cloud-pak', 'Configure-cloud-pak', 'Deploy-assets', 'Smoke-tests']\n---\n\n# Provision infrastructure\n\nThis stage will provision the infrastructure that was defined in the input configuration files. Currently, this has only been implemented for IBM Cloud.\n\n## IBM Cloud\nThe IBM Cloud infrastructure provisioning runs Terraform to initially provision the infrastructure components such as VPC, VSIs, security groups, ROKS cluster and others. Also, if changes have been made in the configuration, Terraform will attempt to make the changes to reach the desired end-state.\n\nBased on the chosen action (apply or destroy), Terraform is instructed to provision or change the infrastructure components or to destroy everything.\n\nThe Terraform state file (tfstate) is maintained in the vault and is critical to enable dynamic updates to the infrastructure. If the state file is lost or corrupted, updates to the infrastructure will have to be done manually. The Ansible tasks have been built in a way that the Terraform state file is always persisted into the vault, even if the apply or destroy process has failed.\n\nThere are 3 main steps:\n\n#### Terraform init\nThis step initializes the Terraform provider (ibm) with the correct version. If needed, the Terraform modules for the provider are downloaded or updated.\n\n#### Terraform plan\nApplying changes to the infrastructure using Terraform based on the input configuration files may cause critical components to be replaced (destroyed and recreated). The plan step checks **what** will be changed. If infrastructure components are destroyed and the `--confirm-destroy` parameter has not be specified for the deployer, the process is aborted.\n\n#### Terraform apply or Terraform destroy\nThis is the execution of the plan and will provision new infrastructure (apply) or destroy everything (destroy).\n\nWhile the Terraform apply or destroy process is running, a `.tfstate` file is updated on disk. When the command completes, the deployer writes this as a secret to the vault so it can be used next time to update (or destroy) the infrastructure components.\n","fileAbsolutePath":"/home/runner/work/cloud-pak-deployer/cloud-pak-deployer/doc/src/pages/cpd-design/process/provision-infra.mdx"}}},"staticQueryHashes":["1364590287","137577622","137577622","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550"]}