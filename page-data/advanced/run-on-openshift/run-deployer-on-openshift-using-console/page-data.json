{"componentChunkName":"component---src-pages-advanced-run-on-openshift-run-deployer-on-openshift-using-console-mdx","path":"/advanced/run-on-openshift/run-deployer-on-openshift-using-console/","result":{"pageContext":{"frontmatter":{"title":"Running deployer on OpenShift using console","tabs":["Run deployer on OpenShift using console","Build image and run deployer on OpenShift","Run deployer wizard on OpenShift"]},"relativePagePath":"/advanced/run-on-openshift/run-deployer-on-openshift-using-console.mdx","titleType":"page","MdxNode":{"id":"712e5cea-6391-5e43-9bec-7eed4d0fe4f3","children":[],"parent":"d1b7cedd-a148-5103-95a5-72567758f0be","internal":{"content":"---\ntitle: Running deployer on OpenShift using console\ntabs:\n  [\n    \"Run deployer on OpenShift using console\",\n    \"Build image and run deployer on OpenShift\",\n    \"Run deployer wizard on OpenShift\",\n  ]\n---\n# Running deployer on OpenShift using console\n\n## Log in to the OpenShift cluster\nLog is as a cluster administrator to be able to run the deployer with the correct permissions.\n\n## Prepare the deployer project and the storage\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: Namespace\nmetadata:\n  creationTimestamp: null\n  name: cloud-pak-deployer\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: system:openshift:scc:privileged\n  namespace: cloud-pak-deployer\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: system:openshift:scc:privileged\nsubjects:\n- kind: ServiceAccount\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: cloud-pak-deployer-cluster-admin\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: cloud-pak-deployer-status\n  namespace: cloud-pak-deployer\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 10Gi\n```\n\n## Set the entitlement key\n* Update the secret below with your Cloud Pak entitlement key. Make sure the key is indented exactly as below.\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: cloud-pak-entitlement-key\n  namespace: cloud-pak-deployer\ntype: Opaque\nstringData:\n  cp-entitlement-key: |\n    YOUR_ENTITLEMENT_KEY\n```\n\n## Configure the Cloud Paks and service to be deployer\n* Update the configuration below to match what you want to deploy, do not change indent\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: cloud-pak-deployer-config\n  namespace: cloud-pak-deployer\ndata:\n  cpd-config.yaml: |\n    global_config:\n      environment_name: demo\n      cloud_platform: existing-ocp\n\n    openshift:\n    - name: cpd-demo\n      ocp_version: \"4.10\"\n      cluster_name: cpd-demo\n      domain_name: example.com\n      openshift_storage:\n      - storage_name: auto-storage\n        storage_type: auto\n\n    cp4d:\n    - project: cpd\n      openshift_cluster_name: cpd-demo\n      cp4d_version: 4.6.2\n      sequential_install: True\n      accept_licenses: True\n      cartridges:\n      - name: cp-foundation\n        license_service:\n          state: disabled\n          threads_per_core: 2\n      - name: lite\n\n      - name: analyticsengine \n        size: small \n        state: removed\n\n      - name: bigsql\n        state: removed\n\n      - name: ca\n        size: small\n        instances:\n        - name: ca-instance\n          metastore_ref: ca-metastore\n        state: removed\n\n      - name: cde\n        state: removed\n\n      - name: datagate\n        state: removed\n\n      - name: datastage-ent-plus\n        state: removed\n\n      - name: db2\n        size: small\n        instances:\n        - name: ca-metastore\n          metadata_size_gb: 20\n          data_size_gb: 20\n          backup_size_gb: 20  \n          transactionlog_size_gb: 20\n        state: removed\n\n      - name: db2wh\n        state: removed\n\n      - name: dmc\n        state: removed\n\n      - name: dods\n        size: small\n        state: removed\n\n      - name: dp\n        size: small\n        state: removed\n\n      - name: dv\n        size: small \n        instances:\n        - name: data-virtualization\n        state: removed\n\n      - name: hadoop\n        size: small\n        state: removed\n\n      - name: mdm\n        size: small\n        wkc_enabled: true\n        state: removed\n\n      - name: openpages\n        state: installed\n        instances:\n        - name: openpages-instance\n          size: xsmall\n\n      - name: planning-analytics\n        state: removed\n\n      - name: rstudio\n        size: small\n        state: removed\n\n      - name: spss\n        state: removed\n\n      - name: voice-gateway\n        replicas: 1\n        state: removed\n\n      - name: watson-assistant\n        size: small\n        state: removed\n\n      - name: watson-discovery\n        state: removed\n\n      - name: watson-ks\n        size: small\n        state: removed\n\n      - name: watson-openscale\n        size: small\n        state: removed\n\n      - name: watson-speech\n        stt_size: xsmall\n        tts_size: xsmall\n        state: removed\n\n      - name: wkc\n        size: small\n        state: removed\n\n      - name: wml\n        size: small\n        state: installed\n\n      - name: wml-accelerator\n        replicas: 1\n        size: small\n        state: removed\n\n      - name: wsl\n        state: installed\n```\n\n## Run the deployer\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the following block (exactly into the window)\n```\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app: cloud-pak-deployer\n  name: cloud-pak-deployer\n  namespace: cloud-pak-deployer\nspec:\n  parallelism: 1\n  completions: 1\n  backoffLimit: 0\n  template:\n    metadata:\n      name: cloud-pak-deployer\n      labels:\n        app: cloud-pak-deployer\n    spec:\n      containers:\n      - name: cloud-pak-deployer\n        image: quay.io/cloud-pak-deployer/cloud-pak-deployer:latest\n        imagePullPolicy: Always\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        env:\n        - name: CONFIG_DIR\n          value: /Data/cpd-config\n        - name: STATUS_DIR\n          value: /Data/cpd-status\n        - name: CP_ENTITLEMENT_KEY\n          valueFrom:\n            secretKeyRef:\n              key: cp-entitlement-key\n              name: cloud-pak-entitlement-key\n        volumeMounts:\n        - name: config-volume\n          mountPath: /Data/cpd-config/config\n        - name: status-volume\n          mountPath: /Data/cpd-status\n        command: [\"/bin/sh\",\"-xc\"]\n        args: \n          - /cloud-pak-deployer/cp-deploy.sh env apply -v\n      restartPolicy: Never\n      securityContext:\n        runAsUser: 0\n      serviceAccountName: cloud-pak-deployer-sa\n      volumes:\n      - name: config-volume\n        configMap:\n          name: cloud-pak-deployer-config\n      - name: status-volume\n        persistentVolumeClaim:\n          claimName: cloud-pak-deployer-status        \n```\n\n## Optional: start debug job\nThe debug job can be useful if you want to access the status directory of the deployer if the deployer job has failed.\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the following block (exactly into the window)\n```\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app: cloud-pak-deployer-debug\n  name: cloud-pak-deployer-debug\n  namespace: cloud-pak-deployer\nspec:\n  parallelism: 1\n  completions: 1\n  backoffLimit: 0\n  template:\n    metadata:\n      name: cloud-pak-deployer-debug\n      labels:\n        app: cloud-pak-deployer-debug\n    spec:\n      containers:\n      - name: cloud-pak-deployer-debug\n        image: quay.io/cloud-pak-deployer/cloud-pak-deployer:latest\n        imagePullPolicy: Always\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        env:\n        - name: CONFIG_DIR\n          value: /Data/cpd-config\n        - name: STATUS_DIR\n          value: /Data/cpd-status\n        volumeMounts:\n        - name: config-volume\n          mountPath: /Data/cpd-config/config\n        - name: status-volume\n          mountPath: /Data/cpd-status\n        command: [\"/bin/sh\",\"-xc\"]\n        args: \n          - sleep infinity\n      restartPolicy: Never\n      securityContext:\n        runAsUser: 0\n      serviceAccountName: cloud-pak-deployer-sa\n      volumes:\n      - name: config-volume\n        configMap:\n          name: cloud-pak-deployer-config\n      - name: status-volume\n        persistentVolumeClaim:\n          claimName: cloud-pak-deployer-status        \n```\n\n## Follow the logs of the deployment\n* Open the OpenShift console\n* Go to Compute --> Pods\n* Select `cloud-pak-deployer` as the project at the top of the page\n* Click the deployer pod\n* Click logs\n","type":"Mdx","contentDigest":"095cc504140a5e4e76ca9523b1a40f07","owner":"gatsby-plugin-mdx","counter":218},"frontmatter":{"title":"Running deployer on OpenShift using console","tabs":["Run deployer on OpenShift using console","Build image and run deployer on OpenShift","Run deployer wizard on OpenShift"]},"exports":{},"rawBody":"---\ntitle: Running deployer on OpenShift using console\ntabs:\n  [\n    \"Run deployer on OpenShift using console\",\n    \"Build image and run deployer on OpenShift\",\n    \"Run deployer wizard on OpenShift\",\n  ]\n---\n# Running deployer on OpenShift using console\n\n## Log in to the OpenShift cluster\nLog is as a cluster administrator to be able to run the deployer with the correct permissions.\n\n## Prepare the deployer project and the storage\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: Namespace\nmetadata:\n  creationTimestamp: null\n  name: cloud-pak-deployer\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: system:openshift:scc:privileged\n  namespace: cloud-pak-deployer\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: system:openshift:scc:privileged\nsubjects:\n- kind: ServiceAccount\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: cloud-pak-deployer-cluster-admin\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: cloud-pak-deployer-sa\n  namespace: cloud-pak-deployer\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: cloud-pak-deployer-status\n  namespace: cloud-pak-deployer\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 10Gi\n```\n\n## Set the entitlement key\n* Update the secret below with your Cloud Pak entitlement key. Make sure the key is indented exactly as below.\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: cloud-pak-entitlement-key\n  namespace: cloud-pak-deployer\ntype: Opaque\nstringData:\n  cp-entitlement-key: |\n    YOUR_ENTITLEMENT_KEY\n```\n\n## Configure the Cloud Paks and service to be deployer\n* Update the configuration below to match what you want to deploy, do not change indent\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the follliwng block (exactly into the window)\n```\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: cloud-pak-deployer-config\n  namespace: cloud-pak-deployer\ndata:\n  cpd-config.yaml: |\n    global_config:\n      environment_name: demo\n      cloud_platform: existing-ocp\n\n    openshift:\n    - name: cpd-demo\n      ocp_version: \"4.10\"\n      cluster_name: cpd-demo\n      domain_name: example.com\n      openshift_storage:\n      - storage_name: auto-storage\n        storage_type: auto\n\n    cp4d:\n    - project: cpd\n      openshift_cluster_name: cpd-demo\n      cp4d_version: 4.6.2\n      sequential_install: True\n      accept_licenses: True\n      cartridges:\n      - name: cp-foundation\n        license_service:\n          state: disabled\n          threads_per_core: 2\n      - name: lite\n\n      - name: analyticsengine \n        size: small \n        state: removed\n\n      - name: bigsql\n        state: removed\n\n      - name: ca\n        size: small\n        instances:\n        - name: ca-instance\n          metastore_ref: ca-metastore\n        state: removed\n\n      - name: cde\n        state: removed\n\n      - name: datagate\n        state: removed\n\n      - name: datastage-ent-plus\n        state: removed\n\n      - name: db2\n        size: small\n        instances:\n        - name: ca-metastore\n          metadata_size_gb: 20\n          data_size_gb: 20\n          backup_size_gb: 20  \n          transactionlog_size_gb: 20\n        state: removed\n\n      - name: db2wh\n        state: removed\n\n      - name: dmc\n        state: removed\n\n      - name: dods\n        size: small\n        state: removed\n\n      - name: dp\n        size: small\n        state: removed\n\n      - name: dv\n        size: small \n        instances:\n        - name: data-virtualization\n        state: removed\n\n      - name: hadoop\n        size: small\n        state: removed\n\n      - name: mdm\n        size: small\n        wkc_enabled: true\n        state: removed\n\n      - name: openpages\n        state: installed\n        instances:\n        - name: openpages-instance\n          size: xsmall\n\n      - name: planning-analytics\n        state: removed\n\n      - name: rstudio\n        size: small\n        state: removed\n\n      - name: spss\n        state: removed\n\n      - name: voice-gateway\n        replicas: 1\n        state: removed\n\n      - name: watson-assistant\n        size: small\n        state: removed\n\n      - name: watson-discovery\n        state: removed\n\n      - name: watson-ks\n        size: small\n        state: removed\n\n      - name: watson-openscale\n        size: small\n        state: removed\n\n      - name: watson-speech\n        stt_size: xsmall\n        tts_size: xsmall\n        state: removed\n\n      - name: wkc\n        size: small\n        state: removed\n\n      - name: wml\n        size: small\n        state: installed\n\n      - name: wml-accelerator\n        replicas: 1\n        size: small\n        state: removed\n\n      - name: wsl\n        state: installed\n```\n\n## Run the deployer\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the following block (exactly into the window)\n```\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app: cloud-pak-deployer\n  name: cloud-pak-deployer\n  namespace: cloud-pak-deployer\nspec:\n  parallelism: 1\n  completions: 1\n  backoffLimit: 0\n  template:\n    metadata:\n      name: cloud-pak-deployer\n      labels:\n        app: cloud-pak-deployer\n    spec:\n      containers:\n      - name: cloud-pak-deployer\n        image: quay.io/cloud-pak-deployer/cloud-pak-deployer:latest\n        imagePullPolicy: Always\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        env:\n        - name: CONFIG_DIR\n          value: /Data/cpd-config\n        - name: STATUS_DIR\n          value: /Data/cpd-status\n        - name: CP_ENTITLEMENT_KEY\n          valueFrom:\n            secretKeyRef:\n              key: cp-entitlement-key\n              name: cloud-pak-entitlement-key\n        volumeMounts:\n        - name: config-volume\n          mountPath: /Data/cpd-config/config\n        - name: status-volume\n          mountPath: /Data/cpd-status\n        command: [\"/bin/sh\",\"-xc\"]\n        args: \n          - /cloud-pak-deployer/cp-deploy.sh env apply -v\n      restartPolicy: Never\n      securityContext:\n        runAsUser: 0\n      serviceAccountName: cloud-pak-deployer-sa\n      volumes:\n      - name: config-volume\n        configMap:\n          name: cloud-pak-deployer-config\n      - name: status-volume\n        persistentVolumeClaim:\n          claimName: cloud-pak-deployer-status        \n```\n\n## Optional: start debug job\nThe debug job can be useful if you want to access the status directory of the deployer if the deployer job has failed.\n* Go to the OpenShift console\n* Click the \"+\" sign at the top of the page\n* Paste the following block (exactly into the window)\n```\napiVersion: batch/v1\nkind: Job\nmetadata:\n  labels:\n    app: cloud-pak-deployer-debug\n  name: cloud-pak-deployer-debug\n  namespace: cloud-pak-deployer\nspec:\n  parallelism: 1\n  completions: 1\n  backoffLimit: 0\n  template:\n    metadata:\n      name: cloud-pak-deployer-debug\n      labels:\n        app: cloud-pak-deployer-debug\n    spec:\n      containers:\n      - name: cloud-pak-deployer-debug\n        image: quay.io/cloud-pak-deployer/cloud-pak-deployer:latest\n        imagePullPolicy: Always\n        terminationMessagePath: /dev/termination-log\n        terminationMessagePolicy: File\n        env:\n        - name: CONFIG_DIR\n          value: /Data/cpd-config\n        - name: STATUS_DIR\n          value: /Data/cpd-status\n        volumeMounts:\n        - name: config-volume\n          mountPath: /Data/cpd-config/config\n        - name: status-volume\n          mountPath: /Data/cpd-status\n        command: [\"/bin/sh\",\"-xc\"]\n        args: \n          - sleep infinity\n      restartPolicy: Never\n      securityContext:\n        runAsUser: 0\n      serviceAccountName: cloud-pak-deployer-sa\n      volumes:\n      - name: config-volume\n        configMap:\n          name: cloud-pak-deployer-config\n      - name: status-volume\n        persistentVolumeClaim:\n          claimName: cloud-pak-deployer-status        \n```\n\n## Follow the logs of the deployment\n* Open the OpenShift console\n* Go to Compute --> Pods\n* Select `cloud-pak-deployer` as the project at the top of the page\n* Click the deployer pod\n* Click logs\n","fileAbsolutePath":"/home/runner/work/cloud-pak-deployer/cloud-pak-deployer/doc/src/pages/advanced/run-on-openshift/run-deployer-on-openshift-using-console.mdx"}}},"staticQueryHashes":["1364590287","137577622","137577622","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550"]}